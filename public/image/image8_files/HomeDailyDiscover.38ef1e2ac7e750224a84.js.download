(("undefined"!=typeof self?self:this).webpackJsonp=("undefined"!=typeof self?self:this).webpackJsonp||[]).push([[87],{1551:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r=32,a={ALL:"ALL",CAMPAIGN:"CAMPAIGN",CATEGORY:"CATEGORY"}},1593:function(e,t,n){"use strict";var r=n(0),a=n(300),o=n.n(a),i=(n(1626),n(41)),c=n.n(i);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l=function(e){var t,n;function a(t){var n;return(n=e.call(this,t)||this)._containerWidth=0,n._scrollWidth=0,n.computeMeasurements=function(){n._tabListRef&&(n._containerWidth=n._tabListRef.offsetWidth,n._scrollWidth=n._tabListRef.scrollWidth)},n.postHeaderUpdate=function(){var e=n.props.activeIndex;n.computeMeasurements(),n.slideIntoView(e)},n.handleTabHeaderClick=function(e){var t=n.props.changeActiveTab;t&&"function"==typeof t&&t(e)},n.slideIntoView=function(e){var t=n._tabRefs[e],r=n._tabWrapperRef;if(t&&r&&!(n._scrollWidth-n._containerWidth<0)){var a=r.scrollLeft||0,o=t.offsetLeft-a,i=t.offsetWidth,c=o-(n._containerWidth-i)/2;a+c<0?c=-a:a+c>n._scrollWidth-n._containerWidth&&(c=n._scrollWidth-n._containerWidth-a),n.cssScrolling(c,t)}},n.cssScrolling=function(e,t){var r=n._tabListRef,a=n._tabWrapperRef,o=n._indicatorRef;if(r&&a&&o){var i=n.props.transitionConfig,c=i.duration,s=i.easeFunction,l=i.delay;r.style.transition="transform "+c+" "+s+" "+l,r.style.transform="translateX("+-e+"px)",o.style.transition="transform "+c+" "+s+" "+l,o.style.transform="translateX("+(t.offsetLeft-e)+"px)",o.style.width=t.clientWidth+"px",n._transitionEndHandler&&r.removeEventListener("transitionend",n._transitionEndHandler),n._transitionEndHandler=function(){n.restoreScrollPosition(t,(a.scrollLeft||0)+e),r.removeEventListener("transitionend",n._transitionEndHandler),n._transitionEndHandler=null},r.addEventListener("transitionend",n._transitionEndHandler)}},n.restoreScrollPosition=function(e,t){var r=n._tabListRef,a=n._indicatorRef;r&&a&&(r.style.transition="transform 0s",r.style.transform="",a.style.transition="transform 0s",a.style.transform="translateX("+e.offsetLeft+"px)",n.scrollTo(t))},n.scrollTo=function(e){requestAnimationFrame(function(){n._tabWrapperRef&&("function"==typeof n._tabWrapperRef.scrollTo?n._tabWrapperRef.scrollTo(e,0):(n._tabWrapperRef.scrollLeft=e,n._tabWrapperRef.scrollTop=0))})},n.indicatorStyle=function(e){var t=n.props,r=t.activeIndex,a=t.headerScrollable,o=t.underlineActiveTab,i=n._tabRefs&&n._tabRefs[r],c={display:o?"block":"none"};return a||(c.width=i?i.clientWidth+"px":100/e+"%",c.transform=i?"translateX("+i.offsetLeft+"px)":"translateX("+100*r+"%)"),c},n._tabRefs=[],n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=a.prototype;return o.componentDidMount=function(){var e=this.props,t=e.headerScrollable,n=e.activeIndex;t&&(this.computeMeasurements(),this.slideIntoView(n))},o.componentDidUpdate=function(e){var t=this.props,n=t.headerScrollable,r=t.activeIndex,a=t.header,o=e.headerScrollable,i=e.activeIndex,c=e.header;n&&(a!==c||a.length!==c.length?requestAnimationFrame(this.postHeaderUpdate):o&&r===i||this.slideIntoView(r))},o.render=function(){var e=this,t=this.props,n=t.headerTop,a=t.header,o=t.activeIndex,i=t.theme,l=t.headerStyle,u=void 0===l?{}:l,d=t.headerScrollable,f=a.filter(function(e){return null!=e}),p=f.length;return r.createElement("nav",{className:c()("stardust-tabs-header-wrapper",d?"stardust-tabs-header-wrapper--scrollable":""),style:s({},u,{top:n}),ref:function(t){return e._tabWrapperRef=t}},r.createElement("ul",{className:c()("stardust-tabs-header",{"stardust-tabs-header--light":"light"===i}),ref:function(t){return e._tabListRef=t}},f.map(function(t,n){return r.createElement("li",{className:c()("stardust-tabs-header__tab",{"stardust-tabs-header__tab--active":o===n}),onClick:function(){return e.handleTabHeaderClick(n)},key:n,ref:function(t){return e._tabRefs[n]=t}},t)})),r.createElement("i",{style:this.indicatorStyle(p),ref:function(t){return e._indicatorRef=t},className:"stardust-tabs-header__tab-indicator"}))},a}(r.Component);function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}l.defaultProps={transitionConfig:{duration:"0.5s",easeFunction:"cubic-bezier(0.15, 0.3, 0.25, 1)",delay:"0s"}};var d=function(e){var t,n;function a(t){var n;return n=e.call(this,t)||this,o()(t.header&&Array.isArray(t.header),"stardust-tabs-container: must pass in an array of ReactElement for the header props"),o()(t.children&&r.Children.count(t.children)===t.header.length,"stardust-tabs-container: tab panels must be equal to the tab headers"),n.state={activeIndex:t.activeIndex,scrollPositions:new Array(t.header.length).fill(0)},n._tabsHeaderAnchorRef=null,n.setTabsHeaderAnchorRef=n.setTabsHeaderAnchorRef.bind(u(n)),n.changeActiveTab=n.changeActiveTab.bind(u(n)),n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=a.prototype;return i.UNSAFE_componentWillReceiveProps=function(e){e.activeIndex!==this.props.activeIndex&&e.activeIndex!==this.state.activeIndex&&this.changeActiveTab(e.activeIndex,!0)},i.componentDidUpdate=function(e){this.updateScrollPositionStateOnUpdate(e.header,this.props.header)},i.updateScrollPositionStateOnUpdate=function(e,t){if(e.length!==t.length){var n=this.state.scrollPositions;this.setState({scrollPositions:Array.from({length:t.length},function(e,t){return n[t]||0})})}},i.setTabsHeaderAnchorRef=function(e){e&&(this._tabsHeaderAnchorRef=e)},i.changeActiveTab=function(e,t){var n=this;if(void 0===t&&(t=!1),(t||!this.props.shouldStopChangeTab||"function"!=typeof this.props.shouldStopChangeTab||!this.props.shouldStopChangeTab(e))&&this._tabsHeaderAnchorRef){var r=function(e){for(var t=0,n=e;n&&n.offsetParent;)"number"==typeof n.offsetTop&&(t+=n.offsetTop),n=n.offsetParent;return t}(this._tabsHeaderAnchorRef)-this.props.headerTop,a=window&&window.scrollY?window.scrollY:0,o=a>=r,i=o?r:a;this.setState({activeIndex:e,scrollPositions:this.state.scrollPositions.map(function(e,t){return o?t===n.state.activeIndex?n.props.scrollTabToTop?0:a-r:e:0})},function(){n.props.onChangeTab&&"function"==typeof n.props.onChangeTab&&n.props.onChangeTab(e);var t=i+n.state.scrollPositions[e];window&&window.scrollTo&&window.scrollTo(window.scrollX,t)})}},i.render=function(){var e=this.props,t=e.header,n=e.headerTop,a=e.children,o=e.theme,i=e.underlineActiveTab,c=e.className,s=e.headerStyle,u=e.headerScrollable,d=e.toRem,f=this.state.activeIndex;return r.createElement("div",{className:c},r.createElement("div",{className:"stardust-tabs-header-anchor",ref:this.setTabsHeaderAnchorRef}),t?r.createElement(l,{activeIndex:f,headerTop:d?d(n):n,changeActiveTab:this.changeActiveTab,header:t,theme:o,underlineActiveTab:i,headerStyle:s,headerScrollable:!!u}):null,r.createElement("div",{className:"stardust-tabs-panels"},r.Children.map(a,function(e,t){return r.createElement("section",{className:"stardust-tabs-panels__panel",style:{display:t!==f?"none":"block"},key:t},e)})))},a}(r.Component);d.defaultProps={headerTop:0,activeIndex:0,theme:"dark",headerScrollable:!1},n.d(t,"a",function(){return d})},1626:function(e,t,n){},1683:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return c});var r=n(1),a=Object(r.b)("FETCH_DAILY_DISCOVER_TAB_CONFIG"),o=Object(r.b)("FETCH_DAILY_DISCOVER_PERSONALIZED_TABS"),i=Object(r.b)("FETCH_DAILY_DISCOVER_COLLECTIONS"),c=Object(r.b)("FETCH_DAILY_DISCOVER_TOP_PRODUCTS")},1684:function(e,t){},1685:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r,a=n(21),o=n(1683),i=n(8),c=n(5);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l={collections:[],topProducts:[],personalizedTabs:{error:0,loading:!1,categories:[]},tabConfig:{error:0,fetchStatus:i.b.INIT,config:{all:{},campaign:[]}}},u=Object(a.a)(((r={})[o.c.REQUESTED]=function(e){return s({},e,{tabConfig:s({},e.tabConfig,{fetchStatus:i.b.REQ,error:0})})},r[o.c.SUCCESS]=function(e,t){return s({},e,{tabConfig:{config:t.data,fetchStatus:i.b.OK,error:0}})},r[o.c.FAILED]=function(e,t){return s({},e,{tabConfig:{config:s({all:{},campaign:[]},Object(c.a)(e,["tabConfig","config"])),fetchStatus:i.b.ERR,error:t.data}})},r[o.b.REQUESTED]=function(e){return s({},e,{personalizedTabs:s({},e.personalizedTabs,{loading:!0,error:0})})},r[o.b.SUCCESS]=function(e,t){return s({},e,{personalizedTabs:{loading:!1,error:0,categories:t.data}})},r[o.b.FAILED]=function(e,t){return s({},e,{personalizedTabs:{loading:!1,error:t.data,categories:[]}})},r[o.a.REQUESTED]=function(e){return s({},e,{collections:[]})},r[o.a.SUCCESS]=function(e,t){return s({},e,{collections:t.data})},r[o.d.REQUESTED]=function(e){return s({},e,{topProducts:[]})},r[o.d.SUCCESS]=function(e,t){return s({},e,{topProducts:t.data})},r),l)},1686:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c});var r=n(5),a=n(8);function o(e){return Object(r.a)(e,["tabConfig","fetchStatus"],a.b.INIT)}function i(e){return Object(r.a)(e,["tabConfig","config","all"])}function c(e){var t=function(e){return Object(r.a)(e,["tabConfig","config","campaign"])}(e);return t?t[0]:void 0}},1727:function(e,t,n){"use strict";var r=n(37),a=n(5);function o(e){return e?{name:e.display_text,color:e.text_color,imageForPC:e.pc_image,imageForApp:e.tab_image,label:e.product_label,recommendType:e.algo_type||0}:{}}var i=n(2);n(1551);var c=n(1683);function s(e){var t=e.shouldSkipCall;return Object(r.a)({apiCall:function(){return Object(i.fetchInfo)("/api/v2/cms/daily_discover_config")},actions:[function(){return{type:c.c.REQUESTED}},function(e,t){var n=Object(a.a)(t,["data","all_tab_config"]),r=Object(a.a)(t,["data","campaign_tabs"],[]);return{type:c.c.SUCCESS,data:{all:o(n),campaign:r.map(function(e){return o(e)})}}},function(e,t){return{type:c.c.FAILED,data:t.error}}],shouldSkipCall:function(e){return"function"==typeof t&&t(e)}})}n.d(t,"a",function(){return s})},1942:function(e,t,n){"use strict";var r=n(1727);n.d(t,"fetchTabConfig",function(){return r.a});var a=n(1684);n.o(a,"dailyDiscoverReducer")&&n.d(t,"dailyDiscoverReducer",function(){return a.dailyDiscoverReducer}),n.o(a,"getAllTabConfig")&&n.d(t,"getAllTabConfig",function(){return a.getAllTabConfig}),n.o(a,"getFirstCampaignTabConfig")&&n.d(t,"getFirstCampaignTabConfig",function(){return a.getFirstCampaignTabConfig}),n.o(a,"getTabConfigFetchStatus")&&n.d(t,"getTabConfigFetchStatus",function(){return a.getTabConfigFetchStatus});var o=n(1685);n.d(t,"dailyDiscoverReducer",function(){return o.a});n(1551);var i=n(1686);n.d(t,"getAllTabConfig",function(){return i.a}),n.d(t,"getFirstCampaignTabConfig",function(){return i.b}),n.d(t,"getTabConfigFetchStatus",function(){return i.c})},3388:function(e,t,n){e.exports={tab:"BBcFUz",activeIndicator:"BFqev7",logo:"_1eqU0X"}},3389:function(e,t,n){e.exports={container:"_2xGR3B",activeIndicator:"_1Z8VkJ",spinner:"_2Il3N3"}},3718:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(72),o=n(51),i=n(1593),c=n(41),s=n.n(c),l=n(1146),u=n(388),d=n(65),f=n(366),p=n(394),b=n(3388),h=n.n(b);var m=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=a.prototype;return o.shouldComponentUpdate=function(e){return Object(f.a)(this.props,e,["recommendType","customTextColor","customHeaderImage","indicatorClassName"])},o.render=function(){var e=this.props,t=e.customTextColor,n=e.customHeaderImage,a=e.indicatorClassName,o=e.trackingClick;return r.createElement(r.Fragment,null,r.createElement("div",{className:s()(h.a.activeIndicator,a||""),style:t?{background:t}:null}),r.createElement("div",{className:h.a.tab,onClick:o},r.createElement(l.a,{headerText:Object(d.t)("label_daily_discover"),customHeader:{color:t,image:n,display_height:p.l.DAILY_DISCOVER_TAB_IMAGE_HEIGHT}})))},a}(r.Component),g=Object(u.a)(m,"HomeRecommendTab"),v=n(926),_=n(809),C=n(123),T=n(871),y=n(396),E=n(303),S=n(5),I=n(301),O=n(8),R=n(399),A=n(865),D=n(222),L=n(55),j=n(297),w=n(390),F=n(1942),x=n(874),H=n(140),P=n(3389),U=n.n(P);function N(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function k(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){N(o,r,a,i,c,"next",e)}function c(e){N(o,r,a,i,c,"throw",e)}i(void 0)})}}var W=118,V=Object(T.a)({loader:function(){return Promise.all([n.e(3),n.e(5),n.e(6),n.e(90)]).then(n.bind(null,3720))}}),B=Object(T.a)({loader:function(){return Promise.all([n.e(5),n.e(18),n.e(94)]).then(n.bind(null,3622))}}),Y=Object(T.a)({loader:function(){return Promise.all([n.e(5),n.e(18),n.e(89)]).then(n.bind(null,3623))}}),G=Object(T.a)({loader:function(){return Promise.all([n.e(5),n.e(18),n.e(88)]).then(n.bind(null,3624))}}),M=function(e){var t,n;function a(t){var n;return(n=e.call(this,t)||this).handleChangeTab=function(e){n.setState({activeTab:e},function(){if(n._ref){var e=Object(y.c)(n._ref).top-W;e<window.pageYOffset&&window.scroll(0,e)}})},n.getRef=function(e){e&&(n._ref=e)},n.loadDailyDiscoverConfig=k(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.props.injectAsyncReducer({dailyDiscoverConfig:F.dailyDiscoverReducer}),e.next=3,n.props.fetchTabConfig({shouldSkipCall:function(e){return Object(F.getTabConfigFetchStatus)(e.dailyDiscoverConfig)===O.b.OK}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)})),n.universalDataFetch=k(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.loadDailyDiscoverConfig();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),n.state={activeTab:0},n}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=a.prototype;return o.UNSAFE_componentWillMount=function(){this.loadDailyDiscoverConfig()},o.shouldComponentUpdate=function(e,t){return e.customHeader!==this.props.customHeader||e.dailyDiscoverConfig!==this.props.dailyDiscoverConfig||e.account!==this.props.account||t.activeTab!==this.state.activeTab},o.getTabs=function(){var e=this.props,t=e.allTabConfig,n=e.campaignTabConfig;return t&&n?[R.a.DAILY_DISCOVER,n.recommendType].map(function(e){var a=t.color,o=null;return n&&e!==R.a.DAILY_DISCOVER&&(a=n.color||a,o=n.imageForPC||o),r.createElement(g,{key:e,recommendType:e,customTextColor:a,customHeaderImage:o,indicatorClassName:U.a.activeIndicator})}):[]},o.getContents=function(){var e=this.state.activeTab,t=this.props,n=t.campaignTabConfig,a=t.isBff;if(!n)return[];var o=Object(I.a)(this.props.account.toJS(),L.a,__LOCALE__).isUserAdult;return[R.a.DAILY_DISCOVER,n.recommendType].map(function(t,i){if(i!==e)return null;if(null===a)return r.createElement(v.a,{show:!0,hideOverlay:!0,spinnerClassName:U.a.spinner});var c=n&&n.label||0;if(0===i)return r.createElement(Y,{key:t,recommendType:t,tabId:i,isUserAdult:o,isBff:a});if(n.recommendType===R.a.BIG_SALE_11_11&&c)return r.createElement(G,{key:t,recommendType:t,labelId:c,tabId:i,isUserAdult:o,isBff:a});if(n.recommendType!==R.a.BIG_SALE_11_11){var s=c?[c]:null;return r.createElement(B,{key:t,recommendType:t,labelIds:s,tabId:i,isUserAdult:o})}return null})},o.render=function(){var e=this.props,t=e.campaignTabConfig,n=e.tabConfigFetchStatus,a=e.isBff;if(z.includes(n))return r.createElement(v.a,{show:!0,hideOverlay:!0,spinnerClassName:U.a.spinner});var o=t&&["imageForPC","name"].every(function(e){return t[e]})&&(t.recommendType!==R.a.BIG_SALE_11_11||!!t.label),c=Object(S.a)(this.props.customHeader,[D.FESTIVAL_CUSTOM_HEADERS.DAILY_DISCOVER,"background_image"])||null,s=c?{backgroundImage:"url("+Object(j.a)(c)+")"}:void 0;if(o)return r.createElement("div",{ref:this.getRef},r.createElement(i.a,{header:this.getTabs(),headerStyle:s,className:U.a.container,headerTop:W,activeIndex:this.state.activeTab,onChangeTab:this.handleChangeTab,toRem:E.a},this.getContents()));var l=Object(S.a)(this.props.customHeader,[D.FESTIVAL_CUSTOM_HEADERS.DAILY_DISCOVER])||null,u=Object(S.a)(this.props.customHeader,[D.FESTIVAL_CUSTOM_HEADERS.DAILY_DISCOVER,"color"]);return r.createElement(V,{headerColor:u,isBff:a,customHeader:l})},a}(r.Component),z=[O.b.INIT,O.b.REQ];t.default=Object(o.d)(_.b,w.b,Object(a.connect)(function(e){var t=e.dailyDiscoverConfig,n=e.featureToggles;return{dailyDiscoverConfig:t,allTabConfig:Object(F.getAllTabConfig)(t),campaignTabConfig:Object(F.getFirstCampaignTabConfig)(t),tabConfigFetchStatus:Object(F.getTabConfigFetchStatus)(t),isBff:Object(x.a)(n,A.a.DAILY_DISCOVER_BFF_API,null),account:Object(H.b)(e)}},{fetchTabConfig:F.fetchTabConfig}),Object(d.withI18nCollections)([119,120]))(Object(C.e)(M,"HomeDailyDiscover"))}}]);
//# sourceMappingURL=https://shopee.sg/assets/HomeDailyDiscover.38ef1e2ac7e750224a84.js.map